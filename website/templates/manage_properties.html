<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Manage Properties</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>

<body>
    <section class="max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8 relative py-4 flex justify-center">
        <div class="flex flex-col lg:flex-row w-full">
            <!-- Sidebar -->
            <aside id="logo-sidebar"
                class="fixed top-0 left-0 z-40 w-64 h-screen transition-transform -translate-x-full sm:translate-x-0 bg-gray-50 dark:bg-gray-800"
                aria-label="Sidebar">
                <div class="h-full px-3 py-4 overflow-y-auto flex flex-col items-center">
                    <!-- Logo -->
                    <div class="flex items-center justify-center w-full mb-4">
                        <a href="{{ url_for('views.home') }}">
                            <img src="{{ url_for('static', filename='images/BlueLogo.png') }}" alt="Logo" class="h-10">
                        </a>
                    </div>

                    <!-- Sidebar links -->
                    <ul class="space-y-2 font-medium w-full">
                        <li class="w-full houses">
                            <a href="#" id="houses-link"
                                class="flex items-center justify-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
                                </svg>
                                <span class="mr-5 ml-2">Houses</span>
                            </a>
                        </li>
                        <li class="w-full orders">
                            <a href="#" id="orders-link"
                                class="flex items-center justify-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 00-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0Zm12.75 0a.75.75 0 11-1.5 0 .75.75 0 011.5 0Z" />
                                </svg>
                                <span class="mr-6 ml-2">Orders</span>
                            </a>
                        </li>
                        <li class="w-full customer">
                            <a href="#"
                                class="flex items-center justify-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
                                </svg>
                                <span class="ml-1">Customers</span>
                            </a>
                        </li>
                        <li class="w-full Reviews">
                            <a href="#"
                                class="flex items-center justify-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z" />
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                                </svg>
                                <span class="mr-4 ml-2">Reviews</span>
                            </a>
                        </li>
                        <li class="w-full settings">
                            <a href="#"
                                class="flex items-center justify-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z" />
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                                </svg>
                                <span class="mr-4 ml-2">Settings</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 max-w-4xl mx-auto mt-20 p-4 border border-gray-200 rounded-lg" id="houses-section">
                <div
                    class="flex flex-col sm:flex-row items-center justify-around text-center sm:gap-28 border-gray-500">
                    <h1 class="text-xl sm:text-2xl text-blue-800">Houses</h1>
                    <div class="flex flex-col sm:flex-row items-center gap-4 sm:gap-10 w-full sm:w-auto">

                        <button type="button" onclick="openModal()"
                            class="w-full sm:w-auto flex justify-center items-center px-5 py-2.5 mb-2 sm:mb-0 text-sm font-medium focus:outline-none bg-blue-900 text-white rounded-lg border border-gray-200 hover:bg-blue-700 hover:text-white focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:bg-gray-700">
                            Add House
                        </button>

                        <form class="flex flex-col sm:flex-row items-center gap-4 w-full sm:w-auto"
                            enctype="multipart/form-data">
                            <div class="relative w-full">
                                <input type="text" id="voice-search"
                                    class="bg-gray-50 border pl-10 pr-4 py-2.5 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                    placeholder="Search Houses" required />
                                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                    <svg class="w-5 h-5 text-gray-500 dark:text-gray-400" aria-hidden="true"
                                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                        stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M10 4a6 6 0 0 1 6 6c0 1.615-.623 3.105-1.757 4.243a6.001 6.001 0 0 1-8.486 0A6.002 6.002 0 0 1 4 10a6 6 0 0 1 6-6m-7 14l3-3m0 0l3-3m-3 3l-3-3" />
                                    </svg>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Houses Section -->
                <section id="houses-section" class="mt-8 lg:mt-0 ml-12">
                    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 relative py-4">
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                    <tr class="text-left text-gray-600">
                                        <th class="py-2 px-3">Houses</th>
                                        <th class="py-2 px-3">Title</th>
                                        <th class="py-2 px-3">ID</th>
                                        <th class="py-2 px-3">Price</th>
                                        <th class="py-2 px-3">Location</th>
                                        <th class="py-2 px-3">Category</th>
                                        <th class="py-2 px-3 text-center">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for property in properties %}
                                    <tr class="hover:bg-gray-50">
                                        <td class="py-4 px-6">
                                            <div class="flex items-center">
                                                <img src="/media/{{ property.image_url }}"
                                                    alt="Image of {{ property.title }}" class="h-8 w-8 mr-2 rounded">



                                            </div>
                                        </td>
                                        <td class="py-3 px-4">{{ property.title }}</td>
                                        <td class="py-3 px-4">{{ property.id }}</td>
                                        <td class="py-3 px-4">${{ property.current_price }}</td>
                                        <td class="py-3 px-4">{{ property.location }}</td>
                                        <td class="py-3 px-4">{{ property.category }}</td>
                                        <td class="py-3 px-4 flex gap-2">
                                            <a href="{{ url_for('admin.manage_properties', edit=property.id) }}"
                                                class="w-full flex justify-center items-center px-5 py-2.5 text-sm font-medium text-blue-900 bg-transparent border border-blue-900 hover:bg-blue-100 focus:outline-none focus:ring-4 focus:ring-blue-300 rounded-lg">Edit</a>
                                            <form
                                                action="{{ url_for('admin.delete_property', property_id=property.id) }}"
                                                method="POST"
                                                onsubmit="return confirm('Are you sure you want to delete this property?');"
                                                class="w-full">
                                                <button type="submit"
                                                    class="w-full flex justify-center items-center px-5 py-2.5 text-sm font-medium text-white bg-blue-900 border border-blue-900 hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 rounded-lg">Delete</button>
                                            </form>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

            </main>
        </div>
    </section>


    <!-- Add Property Modal -->
    <div id="addHouseModal" id="houses-section"
        class="hidden fixed inset-0 z-50 flex items-center justify-center bg-gray-800 bg-opacity-75">
        <div class="bg-white p-6 rounded-lg shadow-lg max-w-md w-full mx-4 sm:mx-auto">
            <h2 class="text-xl font-semibold mb-4 text-center text-blue-600">Add House</h2>
            <form action="{{ url_for('admin.manage_properties') }}" method="POST" enctype="multipart/form-data">
                {{ form.hidden_tag() }}
                <div class="mb-4">
                    {{ form.title.label(class="block text-gray-700 text-sm font-bold mb-2") }}
                    {{ form.title(class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700
                    leading-tight focus:outline-none focus:shadow-outline") }}
                </div>
                <div class="mb-4">
                    {{ form.description.label(class="block text-gray-700 text-sm font-bold mb-2") }}
                    {{ form.description(class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700
                    leading-tight focus:outline-none focus:shadow-outline") }}
                </div>
                <div class="mb-4">
                    {{ form.current_price.label(class="block text-gray-700 text-sm font-bold mb-2") }}
                    {{ form.current_price(class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700
                    leading-tight focus:outline-none focus:shadow-outline") }}
                </div>
                <div class="mb-4">
                    {{ form.location.label(class="block text-gray-700 text-sm font-bold mb-2") }}
                    {{ form.location(class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700
                    leading-tight focus:outline-none focus:shadow-outline") }}
                </div>
                <div class="mb-4">
                    {{ form.category.label(class="block text-gray-700 text-sm font-bold mb-2") }}
                    {{ form.category(class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700
                    leading-tight focus:outline-none focus:shadow-outline") }}
                </div>
                <div class="mb-4">
                    {{ form.image_url.label(class="block text-gray-700 text-sm font-bold mb-2") }}
                    {{ form.image_url(class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700
                    leading-tight focus:outline-none focus:shadow-outline") }}
                </div>

                <div class="flex items-center justify-end mt-4">
                    <button type="button" onclick="closeModal()"
                        class="mr-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg">Cancel</button>
                    <button type="submit"
                        class="bg-blue-600 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded-lg">Add
                        Property</button>
                </div>
            </form>
        </div>
    </div>

    {% if edit_form %}
    <!-- Edit Property Modal -->
    <div id="edit-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-800 bg-opacity-75"
        id="houses-section">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-md w-full mx-4 sm:mx-auto">
            <h2 class="text-xl font-semibold mb-4 text-center text-blue-600">Edit Property</h2>
            <form method="POST" action="{{ url_for('admin.manage_properties', edit=edit_property.id) }}">
                {{ edit_form.hidden_tag() }}
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="mb-4">
                        {{ edit_form.image_url.label(class="block text-gray-700 dark:text-gray-300") }}
                        {{ edit_form.image_url(class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300
                        rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700
                        dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500") }}
                    </div>
                    <div class="mb-4">
                        {{ edit_form.title.label(class="block text-gray-700 dark:text-gray-300") }}
                        {{ edit_form.title(class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md
                        shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700
                        dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500") }}
                    </div>
                    <div class="mb-4">
                        {{ edit_form.current_price.label(class="block text-gray-700 dark:text-gray-300") }}
                        {{ edit_form.current_price(class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300
                        rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700
                        dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500") }}
                    </div>
                    <div class="mb-4">
                        {{ edit_form.location.label(class="block text-gray-700 dark:text-gray-300") }}
                        {{ edit_form.location(class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300
                        rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700
                        dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500") }}
                    </div>
                    <div class="mb-4">
                        {{ edit_form.category.label(class="block text-gray-700 dark:text-gray-300") }}
                        {{ edit_form.category(class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300
                        rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700
                        dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500") }}
                    </div>
                </div>
                <div class="mb-4">
                    {{ edit_form.description.label(class="block text-gray-700 dark:text-gray-300") }}
                    {{ edit_form.description(class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300
                    rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700
                    dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500") }}
                </div>

                <div class="flex justify-end">
                    <button type="button" onclick="closeEditModal()"
                        class="mr-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg">Cancel</button>
                    <button type="submit"
                        class="ml-2 px-4 py-2 bg-blue-800 text-white rounded-md hover:bg-blue-600">Update
                        Property</button>
                </div>
            </form>
        </div>
    </div>
    {% endif %}


    <!-- Logout Button -->
    <a href="{{ url_for('auth.log_out') }}"
        class="fixed bottom-4 right-4 p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group">
        <svg xmlns="http://www.w3.org/2000/svg"
            class="w-6 h-6 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white"
            fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H7a2 2 0 01-2-2V5a2 2 0 012-2h4a2 2 0 012 2v1" />
        </svg>
    </a>
    <script src="{{ url_for('static', filename='js/script.js')}}"></script>
</body>

</html>